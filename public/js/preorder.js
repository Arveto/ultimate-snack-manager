var preorders=[];socket.on("preorder",a=>{currentUser.admin&&addPreorder(a)}),socket.on("preorderFailure",()=>{notif("danger","Erreur: vous avez d\xE9j\xE0 une pr\xE9commande en cours!")}),socket.on("updatePreorderPrice",a=>{editSoldHTML(a.customerId,a.price)});function precoButtonDirtyFuncBecauseDidntFollowedPOOPrecepts(a){for(let b=0;b<preorders.length;b++)if(preorders[b].customerId==a){let c=0;for(let a=0;a<preorders[b].commandList.length;a++)for(let d=0;d<preorders[b].commandList[a].amount;d++){"".concat(preorders[b].commandList[a].id.toString());for(let d=0;d<products.length;d++)if(d==preorders[b].commandList[a].id){c=parseFloat(c+products[d].price.toFixed(2));break}}socket.emit("validatePreorder",{customerId:a,commandList:"",price:c.toFixed(2)}),notif("success","La commande a bien \xE9t\xE9 trait\xE9e!"),$(".media.box.preco"+a.toString()).remove();let d;for(let b=0;b<users.length;b++)if(a==users[b].id){d=b;break}users[d].sold-=c,$("#lastOrder").html(users[d].fiName+" "+users[d].faName);let e=parseInt($("#nOrdersSession").html())+1;$("#nOrdersSession").html(e.toString()),$("#profit").html(c+"\u20AC")}}function removePreorder(a){$(".media.box.preco"+a.toString()).remove(),notif("info","Commande supprim\xE9e"),socket.emit("removePreorder",{customerId:a})}function addPreorder(a){a.commandList=a.commandList.split(",");let b,c=[];for(let d=0;d<a.commandList.length;d++){b=!1;for(let e=0;e<c.length;e++)if(a.commandList[d]==c[e].id){c[e].amount++,b=!0;break}b||c.push({id:a.commandList[d],amount:1})}a.commandList=c;let d=a.name.fiName;""!=a.name.pseudo&&(d+=" \""+a.name.pseudo+"\" "),d+=a.name.faName;let e=new Date(Date.parse(a.date)),f=e.getHours().toString()+":"+e.getMinutes().toString()+":"+e.getSeconds().toString();"NaN:NaN:NaN"==f&&(e=new Date,f=e.getHours().toString()+":"+e.getMinutes().toString()+":"+e.getSeconds().toString()),notif("info","<b>"+a.name.fiName+" "+a.name.faName+"</b> a envoy\xE9 une commande !");let g=$("<article>").addClass("media box preco"+a.customerId).appendTo("#preorders");g.html("    <figure class=\"media-left\">    <p class=\"image is-48x48\">    <img src=\"https://api.adorable.io/avatars/100/"+a.name.faName+a.name.fiName+".png\">    </p>    </figure>    <div class=\"media-content\">    <div class=\"content\">    <p>    <strong>"+d+"</strong>&nbsp;\xB7&nbsp;<small class=\"preorder-uptime\">\xE0 "+f+"</small><br/>    <ul id=\"preco"+a.customerId+"\">    </ul>    </p>    </div>    </div>    <div class=\"media-right\">    <button class=\"button is-medium is-failure preco\" onclick=\"removePreorder("+a.customerId+")\">    <span class=\"icon is-large is-left\">    <i class=\"fa fa-trash-alt \"></i>    </span>    </button>    <button class=\"button is-medium is-success preco\" onclick=\"precoButtonDirtyFuncBecauseDidntFollowedPOOPrecepts("+a.customerId+")\"><!--I m sorry for that..-->    <span class=\"icon is-large is-left\">    <i class=\"fa fa-arrow-right\"></i>    </span>    </button>    </div><br/>");for(let b=0;b<c.length;b++)for(let d=0;d<products.length;d++)if(products[d].id==c[b].id){$("<li>").html(products[d].name+"(x"+c[b].amount+")").appendTo("#preco"+a.customerId);break}preorders.push(a)}