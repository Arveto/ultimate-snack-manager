let totalPrice,commandList=[],isProf=!1,isMember=!1;$(".product").on("click",function(a){a.stopPropagation();let b=getIdFromClassName(this);appendProduct(b)}),$("div.product").on("contextmenu",function(a){a.stopPropagation(),a.preventDefault();let b=getIdFromClassName(this);-1<commandList.hasOwnProperty(b)&&decrementProduct(b)}),$("#deleteAllProducts").on("click",()=>{deleteAllProducts()}),$("#submitCommand").on("click",()=>{if(logged){$("#submitLogin").addClass("is-loading"),orderArray=[];for(let a=0;a<commandList.length;a++)for(let b=0;b<commandList[0].amount;b++)orderArray.push(commandList[a].id);if(!personalOrder&&!isProf){let a={admin:currentUser,customerId:customerId,commandList:orderArray,price:totalPrice.toFixed(2)},b=parseInt($("#nOrdersSession").html())+1;$("#nOrdersSession").html(b.toString());let c=parseInt($("#profit").html())+totalPrice.toFixed(2);$("#profit").html(c.toString()+" \u20AC");for(let a=0;a<users.length;a++)users[a].id==customerId&&$("#lastOrder").html(users[a].fiName+" "+users[a].faName);socket.emit("order",a),editSoldHTML(a.customerId,a.price)}else if(!isProf){let a={customerId:currentUser.id,commandList:orderArray,price:totalPrice.toFixed(2)};socket.emit("preorder",a)}else{let a={admin:currentUser,commandList:orderArray,price:totalPrice.toFixed(2)};console.log(a),socket.emit("profOrder",a)}}commandList=[],$("#commandList").empty(),updatePrice()}),socket.on("commandReceived",()=>{$("#submitLogin").removeClass("is-loading"),notif("success","La commande a bien \xE9t\xE9 effectu\xE9e"),leaveOrdering()});function appendProduct(a){let b=!1;for(let c=0;c<commandList.length;c++)commandList[c].id==a&&(b=!0,incrementProduct(a));if(!b){commandList.push({id:a,amount:1});let b="",c=0;for(let d=0;d<products.length;d++)if(products[d].id==a){b=products[d].name,c=products[d].price.toFixed(2);break}$("<article>").addClass("media productContainer"+a).html("        <figure class=\"media-left\">        <p class=\"image is-48x48\">        <img src=\"img/logo.jpg\">        </p>        </figure>        <div class=\"media-content\">        <div class=\"content\">        <p>        <strong id=\"p"+a+"\">"+b+" (x1)</strong><br/>        <small>Prix <a>"+c+"</a> \u20AC</small>        </p>        </div>        </div>        <div class=\"media-right order-small-modifiers\">        <button onclick=\"deleteProduct("+a+")\" class=\"delete is-bigger\"></button>        <div onclick=\"incrementProduct("+a+")\" class=\"incProd is-big\">        <i class=\"fa fa-plus-circle\" ></i>        </div>        <div onclick=\"decrementProduct("+a+")\" class=\"decProd is-small\">        <i class=\"fa fa-minus-circle\"></i>        </div>      </div>        ").appendTo("#commandList"),updatePrice(),scrollDown("#commandList")}}function incrementProduct(a){productIndex=-1;for(let b=0;b<products.length;b++)if(products[b].id==a){productIndex=b;break}commandIndex=-1;for(let b=0;b<commandList.length;b++)if(a==commandList[b].id){commandList[b].amount++,commandIndex=b;break}$("#p"+a).html(products[productIndex].name+"&nbsp; (&times "+commandList[commandIndex].amount+")"),updatePrice()}function decrementProduct(a){productIndex=-1;for(let b=0;b<products.length;b++)if(products[b].id==a){productIndex=b;break}commandIndex=-1;for(let b=0;b<commandList.length;b++)if(a==commandList[b].id){commandList[b].amount--,0==commandList[b].amount&&deleteProduct(a),commandIndex=b;break}0<commandList.length&&0<commandList[commandIndex].amount&&$("#p"+a).html(products[productIndex].name+"&nbsp; (&times "+commandList[commandIndex].amount+")"),updatePrice()}function deleteProduct(a){$("article.media.productContainer"+a).remove();for(let b=0;b<commandList.length;b++)if(commandList[b].id==a){commandList.splice(b,1);break}updatePrice()}function deleteAllProducts(){commandList=[],$("#commandList").empty(),updatePrice()}function updatePrice(){totalPrice=0;for(let a=0;a<commandList.length;a++)for(let b=0;b<products.length;b++)products[b].id==commandList[a].id&&(totalPrice+=commandList[a].amount*products[b].price.toFixed(2),isMember||(totalPrice+=commandList[a].amount*.1.toFixed(2)));$("#total").html(totalPrice.toFixed(2)+" \u20AC")}function leaveOrdering(){deleteAllProducts(),changeView("userSelection"),customerId=null,commandList=[],$("#commandList").empty(),updatePrice()}