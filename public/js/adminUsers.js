let editedUser,edition={};function bindUserAdmin(){$(".adminUserAction").unbind().click(function(a){if(a.stopPropagation(),currentUser.superadmin){let b,c=a.target.closest(".adminUserAction"),d=getIdFromClassName(c);for(let a=0;a<users.length;a++)users[a].id==d&&(b=a);switch(edition=users[b],c.className.match(/action_[^ ]*/g)[0]){case"action_toggleSetAdminUser":edition.admin=!edition.admin,sendEdition(edition);break;case"action_toggleSetMemberUser":edition.adherent=!edition.adherent,sendEdition(edition);break;case"action_editUser":editedUser=edition.id,userAdminPopup(edition);break;case"action_removeUser":edition.remove=!0,sendEdition(edition),edition={};break;default:alert("Impossible, une erreur dans mon code ??");}}})}function sendEdition(a){socket.emit("editUser",{admin:currentUser,edition:a}),$("#adminUsers div.blur").removeClass("blur"),$("#userAdministrationPopup").hide()}function userAdminPopup(){$("#adminUsers div").addClass("blur"),$("#userAdministrationPopup").show(),$("#userAdmin_avatar").attr("src","https://api.adorable.io/avatars/100/"+edition.faName+edition.fiName+".png"),$(".title.userAdminName").html(edition.name),$("#userAdmin_fiName").val(edition.fiName),$("#userAdmin_faName").val(edition.faName),$("#userAdmin_pseudo").val(edition.pseudo),$("#userAdmin_money").val(edition.balance),$("#userAdmin_email").val(edition.email)}$("#userAdmin_apply").on("click",()=>{for(let a=0;a<users.length;a++)if(users[a].id=editedUser){edition=users[a];break}edition.fiName=$("#userAdmin_fiName").val(),edition.faName=$("#userAdmin_faName").val(),edition.pseudo=$("#userAdmin_pseudo").val(),edition.balance=$("#userAdmin_money").val(),edition.email=$("#userAdmin_email").val(),sendEdition(edition)});function editUsersSolde(a){let b;for(let c=0;c<users.length;c++)users[c].id==a&&(b=c);edition=users[b],$(".user"+a+"_solde").addClass("box").attr("contenteditable",!0),$(".user"+a+"_solde").on("keypress",b=>{let c=b.keyCode||b.which;13==c&&(edition.balance=$(".user"+a+"_solde").html(),sendEdition(edition),$(".user"+a+"_solde").removeClass("box").attr("contenteditable",!1),$(".user"+a+"_solde").off("keypress"))})}socket.on("editUser",a=>{let b;for(let c=0;c<users.length;c++)if(users[c].id==a.id){b=c;break}a.hasOwnProperty("remove")?($("#user"+a.id).remove(),users.splice(b,1)):(users[b]=a,$(".userAdmin_info"+a.id+" strong").html(a.name),$(".user"+a.id+"_solde").html(a.balance),a.admin?($("."+a.id+".adminUserAction .isNotCafetier").addClass("confirmedAdmin").hide(),$("."+a.id+".adminUserAction .isCafetier").addClass("confirmedAdmin").show()):($("."+a.id+".adminUserAction .isCafetier").removeClass("confirmedAdmin").hide(),$("."+a.id+".adminUserAction .isNotCafetier").removeClass("confirmedAdmin").show()),a.adherent?($("."+a.id+".adminUserAction .isNotMember").addClass("confirmedAdmin").hide(),$("."+a.id+".adminUserAction .isMember").addClass("confirmedAdmin").show()):($("."+a.id+".adminUserAction .isMember").removeClass("confirmedAdmin").hide(),$("."+a.id+".adminUserAction .isNotMember").removeClass("confirmedAdmin").show()))});function insertUserAdmin(a,b){a.append("<article class=\"media adminUser"+b.id+"\">    <figure class=\"media-left\">        <p class=\"image is-48x48\">            <img src=\"https://api.adorable.io/avatars/100/"+b.faName+b.fiName+".png\">        </p>    </figure>    <div class=\"media-content columns\">        <div class=\"content column\">            <p class=\"userAdmin_info"+b.fiName+" "+b.fiName+"\">                <strong>"+b.fiName+" "+b.faName+"</strong><br/>                <small>Solde : <a class=\"user"+b.id+"_solde\" onclick=\"editUsersSolde("+b.id+")\" id=\"adminSold"+b.id+"\">"+b.balance+"</a>\u20AC</small>            </p>        </div>        <div class=\"column has-text-centered "+b.id+" action_toggleSetMemberUser adminUserAction\">          <p class=\"heading\">            Adh\xE9rent          </p>          <p class=\"subtitle isMember\" id=\"isMember"+b.id+"\">            <i class=\"fa fa-check\"></i>          </p>          <p class=\"subtitle isNotMember\" id=\"isNotMember"+b.id+"\">            <i class=\"fa fa-times\"></i>          </p>        </div>        <div class=\"column has-text-centered "+b.id+" action_toggleSetAdminUser adminUserAction\">          <p class=\"heading\">            Cafetier          </p>          <p class=\"subtitle isCafetier\" id=\"isAdmin"+b.id+"\">            <i class=\"fa fa-coffee\"></i>          </p>          <p class=\"subtitle isNotCafetier\" id=\"isNotAdmin"+b.id+"\">            <i class=\"fa fa-times\"></i>          </p>        </div>        <div class=\"column has-text-centered superadmin "+b.id+" action_editUser adminUserAction\">          <p class=\"heading\">            Editer          </p>          <p class=\"subtitle\">            <i class=\"fa fa-user-edit\"></i>          </p>        </div>        <div class=\"column has-text-centered superadmin "+b.id+" action_removeUser adminUserAction\">          <p class=\"heading\">            Supprimer          </p>          <p class=\"subtitle\">            <i class=\"fa fa-trash\"></i>          </p>        </div>    </div>    </article>"),b.admin?($("#isAdmin"+b.id).addClass("confirmedAdmin"),$("#isNotAdmin"+b.id).addClass("confirmedAdmin")):($("#isAdmin"+b.id).hide(),$("#isNotAdmin"+b.id).show()),0==b.adherent?($("#isMember"+b.id).hide(),$("#isNotMember"+b.id).show()):($("#isMember"+b.id).addClass("confirmedAdmin"),$("#isNotMember"+b.id).hide().addClass("confirmedAdmin"))}$("#adminUsersInput").on("keyup",a=>{let b=a.keyCode||a.which;switch(b){case 38:a.preventDefault();break;case 40:a.preventDefault();break;case 13:a.preventDefault();break;default:let c=$("#adminUsersInput").val();users.forEach(a=>{0>a.name.toLowerCase().search(c.toLowerCase())?$(".adminUser"+a.id).hide():$(".adminUser"+a.id).show()});}});